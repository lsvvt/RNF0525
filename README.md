# DFT Functional Benchmarking Suite

## Description

This project provides a suite for benchmarking the performance of various Density Functional Theory (DFT) functionals against reference datasets for chemical systems. It utilizes the PySCF library for quantum chemistry calculations.

## Features

*   Runs DFT calculations using PySCF.
*   Supports a range of functionals:
    *   Standard DFT functionals (LDA, PBE, B3LYP, etc.)
    *   Meta-GGA functionals (M06-L, M06-2X, SCAN, etc.)
    *   Custom parameterized functionals via LibXC (`piM06-2X`, `piM06-2X-DL`)
    *   DeepMind's DM21 neural network functional.
*   Calculates Mean Absolute Error (MAE) and Maximum Absolute Error (MaxAE) against reference datasets.
*   Includes scripts for generating YAML-based datasets (H4, HOCl, NaCl, CTB22).
*   Caches calculation results in the `bak/` directory to speed up repeated runs.
*   Supports both CPU and GPU execution (requires appropriate setup).

## Project Structure

```
.
├── run.py                  # Main script for running benchmarks
├── gen_dataset_*.py        # Scripts to generate YAML datasets (e.g., gen_dataset_h4.py)
├── *.yaml                  # Dataset files (geometries, reactions, reference data)
├── *.csv                   # Output files with MAE/MaxAE results
├── *.npy                   # Parameters for custom functionals (e.g., par_pbe0pbe0_old.npy)
├── requirements_dm21.txt   # Dependencies for DM21 env
├── requirements_fast.txt   # Dependencies for fast calc
├── bak/                    # Directory for cached calculation results
├── H4/                     # Files related to the H4 dataset
├── CTB22/                  # Files related to the CTB22 dataset
└── README.md               # This file
```

## Setup

1.  **Clone the repository (if applicable):**
    ```bash
    git clone <repository-url>
    cd <repository-directory>
    ```

2.  **Create and activate a Python virtual environment:**
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows use `venv\Scripts\activate`
    ```

3.  **Install dependencies:**
    *   For DM21 but slow:
        ```bash
        pip install -r requirements_dm21.txt
        ```
    *   For a fast excluding DM21:
        ```bash
        pip install -r requirements_fast.txt
        ```
    *   **Note:** GPU execution requires a compatible NVIDIA GPU, CUDA toolkit, and relevant libraries (CuPy, gpu4pyscf). See `requirements_dm21.txt` or `requirements_fast.txt` for specific versions.

## Usage

1.  **Generate Datasets (Optional):**
    If the YAML database files (`*.yaml`) are not present, you might need to generate them first (example for H4):
    ```bash
    python gen_dataset_h4.py
    ```
    *(Repeat for other `gen_dataset_*.py` scripts if needed)*

2.  **Run Benchmarks:**
    Execute the main script, providing the path to the dataset YAML file. Optionally add `gpu` as the second argument to enable GPU acceleration.
    ```bash
    # Example using CPU for the H4 dataset
    python run.py h4_database.yaml

    # Example using GPU for the CTB22 dataset
    python run.py ctb22_reactions_database.yaml gpu
    ```
    Results (MAE, MaxAE) will be printed to the console and saved to a corresponding CSV file (e.g., `h4_database.yaml_data.csv`).

## Datasets

The following datasets are included or can be generated:

*   **H4:** A simple dataset involving H4 molecule geometries. Generated by `gen_dataset_h4.py`.
*   **HOCl Dissociation:** Dataset for the dissociation of Hypochlorous acid. Generated by `gen_dataset_hocl.py`. Reference data likely from `HOCl_CCSD(T).txt`.
*   **NaCl:** Dataset related to Sodium Chloride. Generated by `gen_dataset_nacl.py`.
*   **CTB22:** A dataset involving chemical reactions (likely bond energies or reaction barriers). Generated by `gen_dataset_ctb22.py`.

## Functionals Benchmarked

The `run.py` script benchmarks the following DFT functionals:

*   LDA
*   M06-L
*   PBE
*   TPSS
*   r2SCAN
*   SCAN
*   SCAN0
*   PBE-2X (Custom PBE hybrid)
*   PBE0
*   M06-2X
*   M05-2X
*   B3LYP
*   DM21 (Requires `requirements_dm21.txt`)
*   piM06-2X-DL (Custom M06-2X variant) (Requires `requirements_dm21.txt`)
*   piM06-2X (Custom M06-2X variant) (Requires `requirements_dm21.txt`)