import sys
import plotly.graph_objects as go
import numpy as np

x = [2.00, 1.90, 1.80, 1.70, 1.60, 1.50, 1.40, 1.30, 1.20, 1.10, 1.00, 0.90]
y = [-2.025084428087608, -2.032345214635941, -2.040450278839692, -2.0487242024393235, -2.056829273084402, -2.06425890614596, -2.0696622908702307, -2.0708442744347546, -2.0667917391122157, -2.054971858377685, -2.0303189469746714, -1.9859099435879288, -2.0367354558675856, -2.043320837039035, -2.0497373330492947, -2.0566604072471946, -2.063245775535989, -2.0688180132148126, -2.072363976791039, -2.072195123836486, -2.066622886157663, -2.0531144436709683, -2.027110695748878, -1.9811819867851876, -2.031500936980523, -2.041801121800096, -2.0532833030668485, -2.0656097555476918, -2.077936214469862, -2.08975610164572, -2.099380861764428, -2.105459658306909, -2.1064727889168804, -2.0990431558553224, -2.0792870509889387, -2.0399437135347065, -2.049568480094742, -2.060037517868868, -2.0715196991356204, -2.083508439266031, -2.0958348981882016, -2.1074859324095065, -2.117110692528214, -2.1236960608170086, -2.12470919142698, -2.11778611722908, -2.0983677311544566, -2.058855534304344, -2.0629080696268836, -2.0738836791473227, -2.086041272232286, -2.0988742900181148, -2.111876173641151, -2.1240337667261144, -2.134502817382895, -2.141594744535348, -2.1434521528007378, -2.137373356258256, -2.118968100793604, -2.0809756062997757]

x = np.array(x)
y = np.array(y)

names = ["FCI / SUMR-CCSD", "CCSD", "PBE", "B3LYP", "O3P86"]
symbols = ["square-x", "square-open", "triangle-up-open", "circle-open", "circle"]

print(len(y) / len(x))
fig = go.Figure()
for i in range(int(len(y) / len(x))):
    fig.add_trace(go.Scatter(x=x, y=y[i * len(x):(i + 1) * len(x)], marker_line_color="black", marker_color="black", name=names[i], mode='markers+lines', marker_size=12, marker_symbol = symbols[i], ))

datain = [{'1': {'DM21': {'Ener': -2.014405016092987, 'Time': 168.29181432724}}, '2': {'DM21': {'Ener': -2.048043931004023, 'Time': 16.67746329307556}}, '3': {'DM21': {'Ener': -2.0625313353150325, 'Time': 15.414436340332031}}, '4': {'DM21': {'Ener': -2.0655298712102947, 'Time': 10.351732969284058}}, '5': {'DM21': {'Ener': -2.061232830051037, 'Time': 13.68491005897522}}, '6': {'DM21': {'Ener': -2.051651432364782, 'Time': 20.657750844955444}}, '7': {'DM21': {'Ener': -2.0380141400579976, 'Time': 15.279814004898071}}, '8': {'DM21': {'Ener': -2.0215289003162, 'Time': 15.243093490600586}}, '9': {'DM21': {'Ener': -2.0077192180839374, 'Time': 17.085250854492188}}, '10': {'DM21': {'Ener': -1.9918664802940877, 'Time': 17.127261877059937}}, '11': {'DM21': {'Ener': -0.6245548402904522, 'Time': 875.0719401836395}}}, {'1': {'B3LYP': {'Ener': -2.0452387743289795, 'Time': 5.282981634140015}}, '2': {'B3LYP': {'Ener': -2.0845062838298904, 'Time': 2.9248108863830566}}, '3': {'B3LYP': {'Ener': -2.1040348024082007, 'Time': 2.224764823913574}}, '4': {'B3LYP': {'Ener': -2.111056639697746, 'Time': 2.1382975578308105}}, '5': {'B3LYP': {'Ener': -2.109925013757871, 'Time': 2.575789213180542}}, '6': {'B3LYP': {'Ener': -2.103487159420199, 'Time': 2.589139699935913}}, '7': {'B3LYP': {'Ener': -2.0937553191451688, 'Time': 2.565864324569702}}, '8': {'B3LYP': {'Ener': -2.0822170285266073, 'Time': 2.6437511444091797}}, '9': {'B3LYP': {'Ener': -2.0699844814166397, 'Time': 2.710177183151245}}, '10': {'B3LYP': {'Ener': -2.057876751668374, 'Time': 2.7984371185302734}}, '11': {'B3LYP': {'Ener': -2.0464722764084726, 'Time': 2.6750662326812744}}}, {'1': {'B3LYP3': {'Ener': -2.058503700653928, 'Time': 5.46266508102417}}, '2': {'B3LYP3': {'Ener': -2.097675923203214, 'Time': 2.3816418647766113}}, '3': {'B3LYP3': {'Ener': -2.1171161448668645, 'Time': 2.134154796600342}}, '4': {'B3LYP3': {'Ener': -2.124058296850116, 'Time': 2.1559877395629883}}, '5': {'B3LYP3': {'Ener': -2.1228560907729, 'Time': 2.3207836151123047}}, '6': {'B3LYP3': {'Ener': -2.116356954487747, 'Time': 2.458138942718506}}, '7': {'B3LYP3': {'Ener': -2.106573850593527, 'Time': 2.3141307830810547}}, '8': {'B3LYP3': {'Ener': -2.094996108632221, 'Time': 2.520376205444336}}, '9': {'B3LYP3': {'Ener': -2.0827389875197007, 'Time': 2.8136696815490723}}, '10': {'B3LYP3': {'Ener': -2.070625560686305, 'Time': 2.5801587104797363}}, '11': {'B3LYP3': {'Ener': -2.0592383068196787, 'Time': 2.721797227859497}}}, {'1': {'M06-2X': {'Ener': -1.9784863001900344, 'Time': 3.5918164253234863}}, '2': {'M06-2X': {'Ener': -2.0152638871545356, 'Time': 1.5194315910339355}}, '3': {'M06-2X': {'Ener': -2.032337961321373, 'Time': 1.6111247539520264}}, '4': {'M06-2X': {'Ener': -2.036908092921327, 'Time': 1.881838083267212}}, '5': {'M06-2X': {'Ener': -2.033168436417589, 'Time': 1.3907597064971924}}, '6': {'M06-2X': {'Ener': -2.023747006796026, 'Time': 1.410433292388916}}, '7': {'M06-2X': {'Ener': -2.0104640568846985, 'Time': 2.054269552230835}}, '8': {'M06-2X': {'Ener': -1.9946879018597046, 'Time': 1.416346788406372}}, '9': {'M06-2X': {'Ener': -1.9774486694046636, 'Time': 1.475342035293579}}, '10': {'M06-2X': {'Ener': -1.9595090773996546, 'Time': 2.1258881092071533}}, '11': {'M06-2X': {'Ener': -1.9414481526387735, 'Time': 1.5460894107818604}}}, {'1': {'wB97M_V': {'Ener': -1.9839385692467801, 'Time': 4.240413188934326}}, '2': {'wB97M_V': {'Ener': -2.0209866694420926, 'Time': 1.4646780490875244}}, '3': {'wB97M_V': {'Ener': -2.0383078254997065, 'Time': 1.7003886699676514}}, '4': {'wB97M_V': {'Ener': -2.043012374314883, 'Time': 1.0931854248046875}}, '5': {'wB97M_V': {'Ener': -2.039324104847968, 'Time': 1.1004149913787842}}, '6': {'wB97M_V': {'Ener': -2.0299618310047594, 'Time': 1.1085991859436035}}, '7': {'wB97M_V': {'Ener': -2.0168121521857247, 'Time': 1.1220872402191162}}, '8': {'wB97M_V': {'Ener': -2.001243749172122, 'Time': 1.1147942543029785}}, '9': {'wB97M_V': {'Ener': -1.9842576773548233, 'Time': 1.5267438888549805}}, '10': {'wB97M_V': {'Ener': -1.9665832664514815, 'Time': 1.1377134323120117}}, '11': {'wB97M_V': {'Ener': -1.9487343738982839, 'Time': 1.1940782070159912}}}, {'1': {'PBE0': {'Ener': -2.0405401393815406, 'Time': 2.0906243324279785}}, '2': {'PBE0': {'Ener': -2.0796039401341533, 'Time': 1.2227132320404053}}, '3': {'PBE0': {'Ener': -2.099042049346698, 'Time': 1.1638250350952148}}, '4': {'PBE0': {'Ener': -2.1060537074115526, 'Time': 1.0488600730895996}}, '5': {'PBE0': {'Ener': -2.104938516071523, 'Time': 1.0701534748077393}}, '6': {'PBE0': {'Ener': -2.0985147494928267, 'Time': 1.0010511875152588}}, '7': {'PBE0': {'Ener': -2.0888044580334633, 'Time': 0.91227126121521}}, '8': {'PBE0': {'Ener': -2.0773378588184985, 'Time': 0.9081935882568359}}, '9': {'PBE0': {'Ener': -2.0652887042482493, 'Time': 1.0126922130584717}}, '10': {'PBE0': {'Ener': -2.053539083878273, 'Time': 1.0075113773345947}}, '11': {'PBE0': {'Ener': -2.042712917258122, 'Time': 1.049088954925537}}}, {'1': {'PBE': {'Ener': -2.013928627719032, 'Time': 3.275202751159668}}, '2': {'PBE': {'Ener': -2.050127160447917, 'Time': 1.7977287769317627}}, '3': {'PBE': {'Ener': -2.0668145137238607, 'Time': 1.115135669708252}}, '4': {'PBE': {'Ener': -2.071166423293227, 'Time': 1.1176388263702393}}, '5': {'PBE': {'Ener': -2.067397395104753, 'Time': 1.245222806930542}}, '6': {'PBE': {'Ener': -2.0582586430087666, 'Time': 1.2438690662384033}}, '7': {'PBE': {'Ener': -2.0456138567989735, 'Time': 1.1639504432678223}}, '8': {'PBE': {'Ener': -2.030867424161895, 'Time': 1.1148386001586914}}, '9': {'PBE': {'Ener': -2.015053215242517, 'Time': 1.0184013843536377}}, '10': {'PBE': {'Ener': -1.998925939857507, 'Time': 1.1385951042175293}}, '11': {'PBE': {'Ener': -1.983017983964019, 'Time': 1.4229028224945068}}}]

for f in datain:
    ### DM21
    [[name,b]] = f["1"].items()
    print(name)
    y = []
    for i in f:
        y.append(f[i][name]["Ener"])

    y.append(np.nan)
    y = np.array(y)[::-1]
    if name == "DM21":
        y[1] = np.nan

    fig.add_trace(go.Scatter(x=x, y=y, name=name + " PySCF", mode='markers+lines', marker_size=12, ))
###


fig.update_layout(template="simple_white", title="")
fig.update_layout(
    xaxis_title="d/Angstrom",
    yaxis_title="Energy/hatree",
    # autosize=False,
    # showlegend=False,
    width=1480,
    height=1050,
    font=dict(
        family="Colibri",
        size=26,
        # color="#7f7f7f"
        color="#000000"
    ),
)

fig.update_layout(legend=dict(
    yanchor="top",
    y=0.99,
    xanchor="right",
    x=0.99
))

fig.update_yaxes(
        title_standoff = 20,
        # dtick = 2,
        range = [-2.16, -1.98])

fig.update_xaxes(
        title_standoff = 20,
        # dtick = 2,
        range = [0.8, 2.4])

fig.show()

# {'1': {'B3LYP-D3': {'Ener': -2.0460518747866194, 'Time': 3.0813333988189697}}, '2': {'B3LYP-D3': {'Ener': -2.085321516715116, 'Time': 1.6872050762176514}}, '3': {'B3LYP-D3': {'Ener': -2.1048587472615, 'Time': 1.3113389015197754}}, '4': {'B3LYP-D3': {'Ener': -2.1119574151384057, 'Time': 1.253225564956665}}, '5': {'B3LYP-D3': {'Ener': -2.1112160044554833, 'Time': 1.2444419860839844}}, '6': {'B3LYP-D3': {'Ener': -2.105302349145907, 'Time': 1.236726999282837}}, '7': {'B3LYP-D3': {'Ener': -2.0956831880648137, 'Time': 1.2380025386810303}}, '8': {'B3LYP-D3': {'Ener': -2.0841642754604086, 'Time': 1.269904375076294}}, '9': {'B3LYP-D3': {'Ener': -2.0719305390632954, 'Time': 1.2507305145263672}}, '10': {'B3LYP-D3': {'Ener': -2.0598130406738284, 'Time': 1.4130339622497559}}, '11': {'B3LYP-D3': {'Ener': -2.048392918083178, 'Time': 1.435497522354126}}}